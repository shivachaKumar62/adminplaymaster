import{r as i,j as e,B as o}from"./index-D-p6wDcO.js";import{M as R}from"./index-B11gck29.js";import{C as q}from"./index-BmqELb-8.js";import{M as D}from"./index-DIrKQdtd.js";import{u as E,M as S}from"./index.esm-DhvTMzvx.js";import{g as T,d as F,a as z,p as A}from"./Api-CIZUh0t2.js";import{B as h}from"./button-BAbZgGKQ.js";import{D as K}from"./index-r8r0RwUx.js";import"./iconBase-BDFc7gl0.js";import"./DefaultLayout-YoSItrYP.js";import"./index.es-DNtyBPSA.js";import"./cil-user-Dlmw-Gem.js";const W=()=>{const[v,x]=i.useState(!1),[b,p]=i.useState(!1),[n,d]=i.useState({bonusName:"",bonusPoints:"",id:null}),[l,c]=i.useState([]),[y,f]=i.useState({visible:!1,id:null}),w=()=>{x(!0)},j=()=>{x(!1),p(!1),d({bonusName:"",id:null})},N=s=>{const{name:t,value:a}=s.target;d(u=>({...u,[t]:a}))};i.useEffect(()=>{(async()=>{try{const t=await T("bonus");c(t==null?void 0:t.data)}catch{o.error("Failed to fetch categories")}})()},[]);const g=i.useMemo(()=>l.map((s,t)=>({...s,index:t+1})),[l]),C=i.useMemo(()=>[{accessorKey:"index",header:"ID",size:150},{accessorKey:"name",header:"Name",size:150},{accessorKey:"points",header:"Points",size:150},{accessorKey:"actions",header:"Actions",size:150,Cell:({row:s})=>e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx(h,{onClick:()=>M(s.original),children:e.jsx(q,{className:"text-lg text-blue-500"})}),e.jsx(h,{onClick:()=>B(s.original._id),children:e.jsx(D,{className:"text-lg text-red-500"})})]})}],[]),M=s=>{p(!0),d({bonusName:s.name,id:s._id,bonusPoints:s.points}),x(!0)},B=s=>{f({visible:!0,id:s})},P=async s=>{try{await F(`bonus/${s}`),o.success("Bonus deleted successfully"),c(t=>t.filter(a=>a._id!==s)),f({visible:!1,id:null})}catch{o.error("Failed to delete category")}};E({columns:C,data:g});const k=async s=>{s.preventDefault();const{bonusName:t,bonusPoints:a,id:u}=n;if(t===""){o.error("Name is required");return}if(a===""){o.error("Points is required");return}try{if(b)await z(`bonus/${u}`,{name:t,points:a}),o.success("Bonus updated successfully"),c(m=>m.map(r=>r._id===u?{...r,name:t,points:a}:r));else{const m=await A("bonus",{name:t,points:a});o.success("Bonus added successfully"),c(r=>[...r,m.data])}j(),d({bonusName:"",id:null,bonusPoints:""}),p(!1)}catch{o.error("Failed to save category")}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-semibold text-[24px] text-gray-500",children:"Bonus"}),e.jsxs("p",{children:["Total Bonus: ",e.jsx("span",{children:l==null?void 0:l.length})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-start my-[30px]",children:e.jsx(h,{type:"primary",onClick:w,children:"Add Bonus"})}),e.jsx(K,{title:b?"Edit Category":"Add Category",onClose:j,open:v,children:e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col mb-4 mt-1",children:[e.jsx("label",{className:"block text-sm text-gray-900 font-semibold mb-2",children:"Name"}),e.jsx("input",{className:"border-2 bg-[white] border-gray-300 rounded-md px-3 py-2 w-full",type:"text",value:n.bonusName,name:"bonusName",onChange:N}),n.bonusName===""&&e.jsx("span",{className:"block text-sm text-red-500 pt-1",children:"This Field is Required !"})]}),e.jsxs("div",{className:"flex flex-col mb-4 mt-1",children:[e.jsx("label",{className:"block text-sm text-gray-900 font-semibold mb-2",children:"Bonus Points"}),e.jsx("input",{className:"border-2 bg-[white] border-gray-300 rounded-md px-3 py-2 w-full",type:"number",value:n.bonusPoints,name:"bonusPoints",onChange:N}),n.bonusPoints===""&&e.jsx("span",{className:"block text-sm text-red-500 pt-1",children:"This Field is Required !"})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-center w-full text-white py-2 rounded-md",children:b?"Update":"Submit"})]})})]}),e.jsx(S,{columns:C,data:g}),e.jsx(R,{title:"Confirm Delete",visible:y.visible,onOk:()=>P(y.id),onCancel:()=>f({visible:!1,id:null}),okText:"Yes",cancelText:"No",children:e.jsx("p",{children:"Are you sure you want to delete this category?"})})]})};export{W as default};
