import{r as a,j as e,B as r}from"./index-D-p6wDcO.js";import{M as R}from"./index-B11gck29.js";import{C as S}from"./index-BmqELb-8.js";import{M as k}from"./index-DIrKQdtd.js";import{u as q,M as A}from"./index.esm-DhvTMzvx.js";import{g as T,d as z,a as K,p as F}from"./Api-CIZUh0t2.js";import{B as h}from"./button-BAbZgGKQ.js";import{D as _}from"./index-r8r0RwUx.js";import"./iconBase-BDFc7gl0.js";import"./DefaultLayout-YoSItrYP.js";import"./index.es-DNtyBPSA.js";import"./cil-user-Dlmw-Gem.js";const Q=()=>{const[C,m]=a.useState(!1),[u,x]=a.useState(!1),[y,d]=a.useState({categoryName:"",id:null}),[l,n]=a.useState([]),[p,f]=a.useState({visible:!1,id:null}),N=()=>{m(!0)},g=()=>{m(!1),x(!1),d({categoryName:"",id:null})},v=t=>{const{name:s,value:i}=t.target;d(o=>({...o,[s]:i}))};a.useEffect(()=>{(async()=>{try{const s=await T("category");n(s==null?void 0:s.data)}catch{r.error("Failed to fetch categories")}})()},[]);const j=a.useMemo(()=>l.map((t,s)=>({...t,index:s+1})),[l]),b=a.useMemo(()=>[{accessorKey:"index",header:"ID",size:150},{accessorKey:"name",header:"Name",size:150},{accessorKey:"createdAt",header:"Created Date",size:150},{accessorKey:"updatedAt",header:"Modified Date",size:200},{accessorKey:"actions",header:"Actions",size:150,Cell:({row:t})=>e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx(h,{onClick:()=>M(t.original),children:e.jsx(S,{className:"text-lg text-blue-500"})}),e.jsx(h,{onClick:()=>w(t.original._id),children:e.jsx(k,{className:"text-lg text-red-500"})})]})}],[]),M=t=>{x(!0),d({categoryName:t.name,id:t._id}),m(!0)},w=t=>{f({visible:!0,id:t})},D=async t=>{try{await z(`category/${t}`),r.success("Category deleted successfully"),n(s=>s.filter(i=>i._id!==t)),f({visible:!1,id:null})}catch{r.error("Failed to delete category")}};q({columns:b,data:j});const E=async t=>{t.preventDefault();const{categoryName:s,id:i}=y;if(s===""){r.error("Name is required");return}try{if(u)await K(`category/${i}`,{name:s}),r.success("Category updated successfully"),n(o=>o.map(c=>c._id===i?{...c,name:s}:c));else{const o=await F("category/create",{name:s});r.success("Category added successfully"),n(c=>[...c,o.data])}g(),d({categoryName:"",id:null}),x(!1)}catch{r.error("Failed to save category")}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-semibold text-[24px] text-gray-500",children:"Category"}),e.jsxs("p",{children:["Total Category: ",e.jsx("span",{children:l==null?void 0:l.length})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-start my-[30px]",children:e.jsx(h,{type:"primary",onClick:N,children:"Add Category"})}),e.jsx(_,{title:u?"Edit Category":"Add Category",onClose:g,open:C,children:e.jsxs("form",{onSubmit:E,children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col mb-4 mt-1",children:[e.jsx("label",{className:"block text-sm text-gray-900 font-semibold mb-2",children:"Name"}),e.jsx("input",{className:"border-2 bg-[white] border-gray-300 rounded-md px-3 py-2 w-full",type:"text",value:y.categoryName,name:"categoryName",onChange:v}),y.categoryName===""&&e.jsx("span",{className:"block text-sm text-red-500 pt-1",children:"This Field is Required !"})]})}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-center w-full text-white py-2 rounded-md",children:u?"Update":"Submit"})]})})]}),e.jsx(A,{columns:b,data:j}),e.jsx(R,{title:"Confirm Delete",visible:p.visible,onOk:()=>D(p.id),onCancel:()=>f({visible:!1,id:null}),okText:"Yes",cancelText:"No",children:e.jsx("p",{children:"Are you sure you want to delete this category?"})})]})};export{Q as default};
