import{r as a,j as e,B as r}from"./index-D-p6wDcO.js";import{M as K}from"./index-B11gck29.js";import{a as v}from"./index-AZsjdKBt.js";import{M as b}from"./index-DIrKQdtd.js";import{M as A}from"./index.esm-DhvTMzvx.js";import{g as C,d as M,p as k}from"./Api-CIZUh0t2.js";import{B as d}from"./button-BAbZgGKQ.js";import"./iconBase-BDFc7gl0.js";import"./DefaultLayout-YoSItrYP.js";import"./index.es-DNtyBPSA.js";import"./cil-user-Dlmw-Gem.js";const z=()=>{const[l,y]=a.useState([]),[i,o]=a.useState({visible:!1,id:null,action:""}),[p,c]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const s=await C("secret/get-key");y(s==null?void 0:s.data)}catch{r.error("Failed to fetch categories")}})()},[p]);const u=t=>Object.values(t).join(""),m=a.useMemo(()=>{var t;return(t=Object.values(l))==null?void 0:t.map((s,n)=>({secretKey:u(s),index:n+1}))},[l]),f=t=>{navigator.clipboard.writeText(t),r.success("Key copied to clipboard!")},h=a.useMemo(()=>[{accessorKey:"index",header:"ID",size:150},{accessorKey:"secretKey",header:"Key",size:150,Cell:({row:t})=>e.jsxs("div",{children:[e.jsxs("span",{className:"bg-gray-200 px-2 py-1",children:[t.original.secretKey.slice(0,10),"..."]}),e.jsx(d,{onClick:()=>f(t.original.secretKey),style:{marginLeft:"10px"},children:e.jsx(v,{})})]})},{accessorKey:"actions",header:"Actions",size:150,Cell:({row:t})=>e.jsx("div",{style:{display:"flex",gap:"10px"},children:e.jsx(d,{onClick:()=>x(t.original.index,"delete"),children:e.jsx(b,{className:"text-lg text-red-500"})})})}],[]),x=(t,s)=>{o({visible:!0,id:t,action:s})},j=async t=>{try{await M("secret/delete-key"),r.success("API Key deleted successfully"),c(s=>!s),o({visible:!1,id:null,action:""})}catch{r.error("Failed to delete API Key"),c(n=>!n)}},g=async()=>{try{const t=await k("secret/generate-key");r.success("API Key added successfully"),y(s=>[...s,t.data]),c(s=>!s),o({visible:!1,id:null,action:""})}catch{r.error("Failed to save API Key"),c(s=>!s)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-semibold text-[24px] text-gray-500",children:"ApiKey"}),e.jsxs("p",{children:["Total ApiKey: ",e.jsx("span",{children:l==null?void 0:l.length})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-start my-[30px]",children:e.jsx(d,{type:"primary",onClick:()=>x(null,"add"),children:"GENERATE NEW KEY"})})}),e.jsx(A,{columns:h,data:m}),e.jsx(K,{title:i.action==="delete"?"Confirm Delete":"Add API Key",visible:i.visible,onOk:()=>{i.action==="delete"?j(i.id):g()},onCancel:()=>o({visible:!1,id:null,action:""}),okText:i.action==="delete"?"Yes":"Add",cancelText:"No",children:i.action==="delete"?e.jsx("p",{children:"Are you sure you want to delete this API Key?"}):e.jsx("p",{children:"Do you want to add a new API Key?"})})]})};export{z as default};
